---
layout: post
title:  "Implementing Turchin's Metaethnic Frontier Theory With NetLogo"
---

### Intro

Peter Turchin is a Quantitative Biologist turned Quantitative Historian. In his approach to history he attempts to capture historical trends and patterns by leveraging data on expired agrarian societies and even adjusting his theories to attempt to [encompass more modern industrial societies](https://amzn.to/2rXuoTc). Building on work by Jack Goldstone, Professor Turchin has proposed various models to explain "historical dynamics" as part of the study he calls Cliodynamics. In one of his early books on Cliodynamics, [Historical Dynamics](https://amzn.to/34R8saV) Turchin lays out details of varous models he uses to try and understand how societies function and evolve. The Metaethnic Frontier theory is proposed to model the geopolitical dynamics of competing polities, leveraging sociological concepts (asabiya) and several assumptions based on previous work. I decided it would be a fun way to try and learn more about agent-based modeling by implementing in NetLogo, a popular piece of software for Agent-Based modeling and simulation.

### NetLogo

NetLogo is an environment for doing Agent-Based Modeling and simulation. The general framework (as I understand it) is that the "observer" manipulates "turtles" (agents), "patches" (space/territory), and "links" (relationships between turtles or patches to each other) through time ("ticks"). The GUI provides graphic representations of the model being built and run, as well as providing ways to easily plot data generated by the model, create buttons to "setup" or run ("go") the model, sliders for adjusting parameters (typically global variables), and other features. The Logo language itself is a lisp-y language that can take some getting used to. NetLogo also has a [library](https://ccl.northwestern.edu/netlogo/models/) of example models that are often helpful for understanding how to implement certain concepts.


### The Theory

[Asabiya](https://en.wikipedia.org/?title=Asabiya&redirect=yes) is a concept from the writings of Ibn Khaldun which Turchin defines as "the capacity for collective action" of a society. The Metaethnic Frontier theory is meant to incorporate asabiya as a factor in predicting the dynamics of imperial agrarian societies - how they grow, shrink, and begin. Turchin posits that [multi-level selection](https://en.wikipedia.org/wiki/Group_selection#Multilevel_selection_theory) can help us identify the dynamics of asabiya in groups. He follows by noting three ways in which the logic of multi-level selection can be relevant in understanding change in "collective solidarity": intergroup conflict, population and resource constrains, and ethnic boundries. 

For small groups intergroup conflict can increase asabiya as people need to band together to survive as a group and, conversely, a large population with respect to available resources can drain asabiya as individuals compete for what exists. For larger groups, Turchin proposes that ethnic boundries can influence how bands of small groucs with moderate ethnic differences can, for example, band together against people who are even more "ethnically distanced" - more "Other". In this process of small groups banding together, they can form what Turchin calls a <em>Metaethnic Frontier</em>, which might manifest in a symbolic form (eg: exclusionary religion). Turchin notes that the this ethnic boundry dynamic which generates asabiya in a large group (composed of smaller groups) is weak because as the size of the group grows larger, the enemies become relatively weaker, and internal division tends to increase in turn. Finally, Turchin notes that all three aforementioned possiblities occur at regions which constitute imperial and metaethnic frontiers. Its is in these regions of intense dynamics where asabiya is forged with particular strength which are most prone to <em>ethnogenesis</em> - where new ethnic identites are formed, and new empires are seeded.

### The Model

The model is predicated on some assumptions and a fairly straightforward set of equations that dictate how values change over the discrete time of the model. The model presumes a matrix of cells ("patches") where each cell is essentially a regional polity - either as part of the "non-imperial hinderland" or as a piece of an empire. Each cell (regional polity) takes on a regional asabiya, and an imperial asabiya (for hinderland regions I set these to be the same value). In addition each cell is assigned an imperial index (0 for hinderland, and some integer for a cell belonging to an empire). Likewise, cells are also assigned some other variables used for calculations.

The regional (cell) asabiya value over time steps ("ticks" in NetLogo) are determined as follows. If the region has a neighbor (not including diagonally adjacent cells) which is of a different imperial index, then asabiya increases in accordance with the following formula:

<img src="https://latex.codecogs.com/png.latex?S_{x,y,t+1}=S_{x,y,t}+r_0S_{x,y,t}(1-S_{x,y,t}) " />

Here, r_0 signifies some defined parameter. Indices x, y, and t represent x and y coordinates of the cell in the matrix, and the time t in ticks, respectively. In the other case, if the region in question is neighbors only with cells of the same imperial index, asabiya decreases according to the following:

<img src="https://latex.codecogs.com/png.latex?S_{x,y,t+1}=S_{x,y,t}-$\delta$S_{x,y,t}" />

Here, delta signifies some defined parameter, again. These are set as global variables in the model. 
Note: I may have differed from the model defined in the book in this respect. I allowed for hinderland regions to attack other 0-indexed regions and possibly conquer them.


Calculating the imperial asabiya at each time step, we simply take the average of the region asabiya of all cells with the respective imperial index:

<img src="https://latex.codecogs.com/png.latex?\bar{S}_{i,t}=\dfrac{1}{A_{i,t}}\sum\limits_{\{x,y\}\in\ i}S_{x,y,t}" />

Here, A signifies number of regions an empire i controls at time step, t.

A "power" equation is needed for calculating outcomes when cells attack each other:

<img src="https://latex.codecogs.com/png.latex?P_{x,y,t}={A_{i,t}}\bar{S}_{i,t}\exp\[-d_{i,x,t}/h]" />

d here represents the distance between the cell in question and the average of the x and y coordinates of the empire. This "average" location is the center of gravity of the empire. h signifies how well imperial power travels over distance.

A cell wins an attack and takes over the defending cell (change of imperial index) when the following is true:

<img src="https://latex.codecogs.com/png.latex?P_{att}-P_{def}\textgreater{\Delta}_{p}" />

Delta_p here denotes a parameter for power differential necessary to declare an attack successful.

Finally, at the end of a time step, we calculate whehter an empire collapses due to falling below a critical imperial asabiya threshold. If this occurs, the empire's cells are set to change to non-imperial hinderland.

<img src="https://latex.codecogs.com/png.latex?\bar{S}_{i,t}\textgreater S_{crit}" />

### The Implementation 
After implementing this in NetLogo, I saw some of the following patterns (and places where my implementation might have deviated in important ways). One important difference I should note is the beginning. I do as Turchin specifies in starting out with a set of four neighboring polities which comprise of the first empire, but in many cases, it is immediately destroyed as in my implementation I am allowing for the hinderland regions to immediately begin attacking. Nevertheless, you can see an interesting consolidation stage where a handful of empires make it out of the initial chaos alive.

![Beginnings](/assets/first_phase.gif)

Once there is a more conslidated set of polities - while still having significant evolution - we can see a great example of a new state appearing at the intersection of some frontiers and exploding outwards. On the right hand side, the light purple empire emerges out of the frontier region between two other large empires. Ethnogenesis in action.

![Ethnogenesis](/assets/ethnogenesis.gif)

Finally, we can witness some empire collpase when a few empires' collective imperial asabiya falls below the critical point.

![Empire Collapse](/assets/collapse.gif)

I also made some graphs showing polity size and imperial asabiyah over time. As expected, as time goes on and the surviving empires become larger regions, the imperial asabiya descreases due to the low asabiya of the central regions of said empires. Likewise, we can see the average size of the polities increase over time in this first cycle, at least.

![NetLogo Graphing](/assets/netlogo_graphing.png)


[Quick Aside: To generate gifs from the NetLogo model run, I used the [export-view function](https://stackoverflow.com/a/26714353) in conjunction with [this](https://stackoverflow.com/a/54138795) imagemagick snippet which sorts the images by filename when creating the gif] 

### Thoughts

NetLogo was an interesting experience, but I'm sure I haven't mastered it yet. You can find the code [here](https://github.com/mbyim/turchin_metaethnic_frontier_theory), let me know if you have any comments or feedback, I'd love to hear it (this is definitely not a perfect implementation).

As this was my first attempt at using NetLogo, I found myself at a bit of a loss at how to implement this particular model and concepts like "self" vs "myself" were quite foreign. Ultimately I decided to . I'm actually not sure whether my implementation is entirely faithful to the original model, as a few details were not entirely clear - and I may have also made some mistakes [do let me know if you have any comments or feedback!]. Nonetheless, I was able to see some of the same dynamics that Turchin describes in the book.


Another explanation/implementation of the Metaethnic Frontier theory (in unity) can be found in [this blog post](https://www.paulkanyuk.com/cliodynamics).

